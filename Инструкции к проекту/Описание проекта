Паяльная станция
Описание

Программно-аппаратный комплекс для управления паяльной станцией с инфракрасным столом и двумя фенами (верхним и нижним). За основу взята неисправная станция модель ZM-R5860 (Отсутствует электронная начинка, панель и контролер. Нагрематели и датчики рабочие станина + обвеска для подключения ESP32S3)
Система построена на контроллере ESP32S3, обеспечивает контроль температуры всех трёх нагревателей и внешней контрольной термопары, выбор профилей пайки, управление процессом и мониторинг в реальном времени.
Управление доступно через веб-панель по Wi-Fi и/или через Serial-порт, а также поддерживается внешнее приложение на PyQt5 для ПК.

Программа реализует PID-регулирование, многофазные температурные профили (до 10 фаз), ведёт логирование температуры на SD-карту, контролирует перегрев и автоматически предлагает скачать лог после окончания пайки.

Функциональные возможности

Подключение к паяльной станции:

через Serial-порт (прямая связь);

через Wi-Fi (в режиме точки доступа AP или клиента STA).

Веб-панель управления на встроенном веб-сервере ESP32S3:

Настройка профиля пайки (до 10 фаз);

Настройка PID-параметров для каждой фазы;

Настройка предельной температуры (аварийное отключение);

Отображение температур 4 зон в реальном времени;

Кнопки управления: Start, Stop, Fan ON/OFF;

Раздел Setup: выбор режима (AP/STA), SSID/PASS, выбор типа памяти (SD/SPIFFS);

Кнопка Download Log — автоматическое скачивание CSV-лога после завершения пайки.

Мониторинг температуры четырёх каналов:

Верхний фен — основной нагреватель над чипом;

Нижний фен — направленный поток под платой;

Инфракрасный стол (IR) — равномерный прогрев основания платы;

Контрольная термопара — устанавливается вручную на чип или область платы для измерения температуры непосредственно в точке пайки.

Многофазные профили пайки (до 10 фаз):

Каждая фаза задаёт целевую температуру, длительность, Kp/Ki коэффициенты PID;

Примеры фаз: Preheat, Soak, Reflow, Cool и др.

PID-регулирование для каждого активного нагревателя с индивидуальными коэффициентами на фазу.

Регулируемая защита от перегрева:

Общий предел температуры;

Возможность задать индивидуальный лимит для каждого канала (опционально).

Логирование температурного процесса:

Автоматическая запись на SD-карту в формате CSV;

Имя файла формируется как /logs/yyyy-mm-dd_hhmm.csv (при наличии NTP-времени);

Возможность просмотра списка логов и скачивания через веб-панель.

Поддержка до 50 сохранённых профилей (в перспективе, через загрузку preset.json).

Плавное управление нагревателями (SSR) по тайм-пропорциональному принципу с окном 1 секунда.

Возможность интеграции с настольным приложением PyQt5 (через Wi-Fi или Serial):

Отображение графиков температуры;

Ручной выбор профилей и контроль процесса;

Мониторинг данных логов.

Требования

Для прошивки ESP32:

Arduino IDE или PlatformIO;

Библиотеки:

WiFi.h, WebServer.h, SPIFFS.h, SD.h, SPI.h;

max6675.h — для чтения термопар;

time.h — для синхронизации NTP (STA mode).

Для ПК-приложения (опционально):

Python 3.6 или выше;

PyQt5;

pyserial;

socket (стандартный модуль Python).

Установка
ESP32

Подключи пины:

Узел	GPIO
MAX6675 #1 (Top fan) CS	5
MAX6675 #2 (Bottom fan) CS	17
MAX6675 #3 (IR table) CS	16
MAX6675 #4 (External TC) CS	4
SCK	18
SO	19
SSR_TOP	25
SSR_BOTTOM	26
SSR_IR	27
FAN_OUT	14
STATUS_LED	2

Залей прошивку из каталога fw_ESP32-S2-DevKitM-1/.

Подключись к Wi-Fi сети ZM-R5860 (пароль reflow123) или настрой STA-режим через вкладку Setup.

Открой в браузере http://192.168.4.1/ (или IP, выданный роутером).

ПК-интерфейс (опционально)
pip install PyQt5 pyserial
python app_py/gui.py

Использование

Подключитесь через Wi-Fi или Serial.

На веб-панели/в приложении отобразятся текущие температуры всех четырёх датчиков.

Выберите профиль пайки или создайте новый (до 10 фаз).

Настройте PID-параметры, лимиты температуры и активные зоны.

Нажмите Start — станция начнёт выполнение профиля.

После завершения нажмите Download Log, чтобы скачать CSV-файл с графиком температур всех каналов.

При необходимости — Stop для экстренного завершения.

Примеры предустановленных профилей пайки

Leaded BGA
Preheat: 150 °C → 180 °C → 220 °C, Peak: 240 °C 20 с, Cool: до 100 °C.

Lead-Free BGA
Preheat: 165 °C → 190 °C → 225 °C, Peak: 255 °C 25 с, Cool: до 100 °C.

SMD / Light boards
140–230 °C с укороченными фазами.

Структура проекта

fw_ESP32-S2-DevKitM-1/ — прошивка ESP32 (веб-сервер, PID-контроль, SD-логирование).

app_py/gui.py — GUI-клиент PyQt5.

app_py/connection.py — управление подключениями (Serial/Wi-Fi).

app_py/commands.py — команды управления.

app_py/temperature.py — обработка данных термопар.

/logs/ — CSV-журналы температурных процессов (SD/SPIFFS).

/preset.json — текущий выбранный профиль пайки.

/config.json — параметры Wi-Fi и хранилища.

Технический обзор системы
Электрическая и логическая структура
+-------------------------------------------------------+
|                        ESP32                          |
|-------------------------------------------------------|
|  Wi-Fi AP/STA, WebServer (UI + API), PID Controller   |
|  SD Logger (CSV), NTP Time Sync, Overheat Protection  |
+-------------------------------------------------------+
      |          |           |            |
  MAX6675#1  MAX6675#2   MAX6675#3   MAX6675#4
   (Top)      (Bottom)     (IR)       (External TC)
      |          |           |            |
   SSR_TOP    SSR_BOTTOM    SSR_IR      (read only)
      |          |           |
   Upper Fan   Lower Fan    IR Table
      |          |           |
   ------------------  SPI Bus  ------------------
      | GPIO18 (SCK), GPIO19 (SO), shared bus
      +-------------------------------------------+
      | SD Card (SPI) — /logs/*.csv, /config.json |
      +-------------------------------------------+
      | FAN_OUT (GPIO14) — вентилятор охлаждения  |
      | LED (GPIO2) — статус                      |
      +-------------------------------------------+

Таблица GPIO
Компонент	Назначение	GPIO	Напряжение	Тип
MAX6675 #1 CS	Верхний фен (Top)	5	3.3 V	вход CS
MAX6675 #2 CS	Нижний фен (Bottom)	17	3.3 V	вход CS
MAX6675 #3 CS	Инфракрасный стол (IR Table)	16	3.3 V	вход CS
MAX6675 #4 CS	Внешняя термопара (Control TC)	4	3.3 V	вход CS
SCK	Общий такт SPI	18	3.3 V	выход
SO	Данные SPI	19	3.3 V	вход
SSR_TOP	Управление верхним феном	25	3.3 V	выход
SSR_BOTTOM	Управление нижним феном	26	3.3 V	выход
SSR_IR	Управление инфракрасным столом	27	3.3 V	выход
FAN_OUT	Вентилятор охлаждения	14	3.3 V	выход
STATUS_LED	Светодиод состояния	2	3.3 V	выход
Взаимосвязи модулей

MAX6675 (x4) — четыре независимых термопары, измеряющие все зоны нагрева и контрольную точку на чипе.

SSR-реле (x3) — управляют верхним, нижним и инфракрасным нагревателями по сигналам GPIO.

PID-контроллер поддерживает заданные температуры каждой зоны в каждой фазе.

SD-карта хранит логи /logs/*.csv, профили /preset.json, конфиг /config.json.

Веб-интерфейс отображает температуры, фазы, логи и настройки системы.

Внешняя термопара используется только для контроля и анализа, не управляет нагревателями напрямую.

Лицензия

См. файл LICENSE
 для дополнительной информации.